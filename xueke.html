<!DOCTYPE html>
<html style="height: 100%">
   <head>
       <meta charset="utf-8">
   </head>
   <body style="height: 100%; margin: 0">
       <div id="container" style="height: 100%"></div>
       <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
       <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-gl/dist/echarts-gl.min.js"></script>
       <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts-stat/dist/ecStat.min.js"></script>
       <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/dataTool.min.js"></script>
       <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
       <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/map/js/world.js"></script> -->
       <!-- <script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=xfhhaTThl11qYVrqLZii6w8qE5ggnhrY&__ec_v__=20190126"></script> -->
       <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts/dist/extension/bmap.min.js"></script> -->
       <script type="text/javascript">
var dom = document.getElementById("container");
var myChart = echarts.init(dom);
var app = {};
option = null;
var subjectJson = {
  "all": 205,
  both: [{"cd":"0714","name":"统计学","sciences":1,"total":1},{"cd":"0101","name":"哲学","sciences":1,"total":1},{"cd":"0602","name":"中国史","sciences":1,"total":1},{"cd":"0834","name":"风景园林学","engineering":1,"total":1},{"cd":"0838","name":"公安技术","engineering":1,"total":1},{"cd":"0829","name":"林业工程","engineering":1,"total":1},{"cd":"1003","name":"口腔医学","engineering":2,"total":2},{"cd":"1006","name":"中西医结合","sciences":1,"engineering":1,"total":2},{"cd":"1202","name":"工商WS","engineering":2,"total":2},{"cd":"0712","name":"科学技术史","sciences":2,"total":2},{"cd":"0839","name":"网络空间安全","sciences":1,"engineering":1,"total":2},{"cd":"0833","name":"城乡规划学","engineering":2,"total":2},{"cd":"1105","name":"军队指挥学","engineering":3,"total":3},{"cd":"0402","name":"心理学","sciences":3,"total":3},{"cd":"0837","name":"安全科学与工程","sciences":1,"engineering":2,"total":3},{"cd":"0835","name":"软件工程","sciences":1,"engineering":2,"total":3},{"cd":"0909","name":"草学","engineering":3,"total":3},{"cd":"1008","name":"中药学","engineering":4,"total":4},{"cd":"0821","name":"纺织科洱工程","engineering":4,"total":4},{"cd":"0831","name":"生物医学工程","engineering":5,"total":5},{"cd":"0832","name":"食品科学与工程","engineering":5,"total":5},{"cd":"0711","name":"系统科学","sciences":5,"engineering":1,"total":6},{"cd":"0822","name":"轻工技术与工程","engineering":6,"total":6},{"cd":"0828","name":"农业工程","sciences":2,"engineering":6,"total":8},{"cd":"0905","name":"畜牧学","sciences":1,"engineering":7,"total":8},{"cd":"0908","name":"水产","sciences":1,"engineering":7,"total":8},{"cd":"0902","name":"园艺学","sciences":1,"engineering":8,"total":9},{"cd":"1004","name":"公共卫生与预防医学","sciences":3,"engineering":7,"total":10},{"cd":"1005","name":"中医学","sciences":4,"engineering":6,"total":10},{"cd":"0903","name":"农业资源与环境","sciences":7,"engineering":3,"total":10},{"cd":"0906","name":"兽医学","sciences":2,"engineering":8,"total":10},{"cd":"0804","name":"仪器科学与技术","sciences":4,"engineering":7,"total":11},{"cd":"1201","name":"管理科学与工程","sciences":1,"engineering":11,"total":12},{"cd":"0713","name":"生态学","sciences":6,"engineering":7,"total":13},{"cd":"0803","name":"光学工程","sciences":6,"engineering":11,"total":17},{"cd":"0823","name":"交通运输工程","sciences":5,"engineering":12,"total":17},{"cd":"0904","name":"植物保护","sciences":8,"engineering":10,"total":18},{"cd":"0824","name":"船舶与海洋工程","sciences":2,"engineering":16,"total":18},{"cd":"0818","name":"地质资源与地质工程","sciences":8,"engineering":11,"total":19},{"cd":"0907","name":"林学","sciences":5,"engineering":14,"total":19},{"cd":"0826","name":"兵器科学与技术","sciences":2,"engineering":18,"total":20},{"cd":"0820","name":"石油与天然气工程","sciences":4,"engineering":19,"total":23},{"cd":"0819","name":"矿业工程","sciences":2,"engineering":21,"total":23},{"cd":"0704","name":"天文学","sciences":23,"engineering":1,"total":24},{"cd":"0707","name":"海洋科学","sciences":13,"engineering":11,"total":24},{"cd":"0830","name":"环境科学与工程","sciences":3,"engineering":22,"total":25},{"cd":"0708","name":"地球物理学","sciences":24,"engineering":2,"total":26},{"cd":"0816","name":"测绘科学与技术","sciences":15,"engineering":12,"total":27},{"cd":"1001","name":"基础医学","sciences":21,"engineering":8,"total":29},{"cd":"0706","name":"大气科学","sciences":22,"engineering":7,"total":29},{"cd":"0705","name":"地理学","sciences":29,"engineering":3,"total":32},{"cd":"0808","name":"电气工程","sciences":13,"engineering":22,"total":35},{"cd":"0813","name":"建筑学","sciences":11,"engineering":24,"total":35},{"cd":"0807","name":"动力工程及工程热物理","sciences":16,"engineering":21,"total":37},{"cd":"1007","name":"药学","sciences":14,"engineering":26,"total":40},{"cd":"0901","name":"作物学","sciences":13,"engineering":27,"total":40},{"cd":"0809","name":"电子科学与技术","sciences":24,"engineering":17,"total":41},{"cd":"0806","name":"冶金工程","sciences":20,"engineering":22,"total":42},{"cd":"0812","name":"计算机科学与技术","sciences":24,"engineering":22,"total":46},{"cd":"0811","name":"控制科洱工程","sciences":27,"engineering":26,"total":53},{"cd":"0815","name":"水利工程","sciences":13,"engineering":40,"total":53},{"cd":"0827","name":"核科学与技术","sciences":31,"engineering":29,"total":60},{"cd":"0810","name":"信息与通信工程","sciences":16,"engineering":46,"total":62},{"cd":"0801","name":"力学","sciences":43,"engineering":20,"total":63},{"cd":"0701","name":"数学","sciences":62,"engineering":2,"total":64},{"cd":"0802","name":"机械工程","sciences":25,"engineering":40,"total":65},{"cd":"0814","name":"土木工程","sciences":13,"engineering":53,"total":66},{"cd":"0817","name":"化学工程与技术","sciences":27,"engineering":41,"total":68},{"cd":"0825","name":"航空宇删泻技术","sciences":20,"engineering":48,"total":68},{"cd":"0805","name":"材料科潍工程","sciences":37,"engineering":70,"total":107},{"cd":"1002","name":"临床医学","sciences":35,"engineering":82,"total":117},{"cd":"0709","name":"地质学","sciences":128,"engineering":12,"total":140},{"cd":"0710","name":"生物学","sciences":169,"engineering":23,"total":192},{"cd":"0702","name":"物理学","sciences":172,"engineering":24,"total":196},{"cd":"0703","name":"化学","sciences":187,"engineering":15,"total":202}]
  ,
  "sciences": [
    {"cd":"0703","name":"化学","count":187},
    {"cd":"0702","name":"物理学","count":172},
    {"cd":"0710","name":"生物学","count":169},
    {"cd":"0709","name":"地质学","count":128},
    {"cd":"0701","name":"数学","count":62},
    {"cd":"0801","name":"力学","count":43},
    {"cd":"0805","name":"材料科学与工程","count":37},
    {"cd":"1002","name":"临床医学","count":35},
    {"cd":"0827","name":"核科学与技术","count":31},
    {"cd":"0705","name":"地理学","count":29},
    {"cd":"0817","name":"化学工程与技术","count":27},
    {"cd":"0811","name":"控制科学与工程","count":27},
    {"cd":"0802","name":"机械工程","count":25},
    {"cd":"0708","name":"地球物理学","count":24},
    {"cd":"0809","name":"电子科学与技术","count":24},
    {"cd":"0812","name":"计算机科学与技术","count":24},
    {"cd":"0704","name":"天文学","count":23},
    {"cd":"0706","name":"大气科学","count":22},
    {"cd":"1001","name":"基础医学","count":21},
    {"cd":"0825","name":"航空宇航科学与技术","count":20},
    {"cd":"0806","name":"冶金工程","count":20},
    {"cd":"0807","name":"动力工程及工程热物理","count":16},
    {"cd":"0810","name":"信息与通信工程","count":16},
    {"cd":"0816","name":"测绘科学与技术","count":15},
    {"cd":"1007","name":"药学","count":14},
    {"cd":"0808","name":"电气工程","count":13},
    {"cd":"0707","name":"海洋科学","count":13},
    {"cd":"0815","name":"水利工程","count":13},
    {"cd":"0814","name":"土木工程","count":13},
    {"cd":"0901","name":"作物学","count":13},
    {"cd":"0813","name":"建筑学","count":11},
    {"cd":"0818","name":"地质资源与地质工程","count":8},
    // {"cd":"0904","name":"植物保护","count":8},
    // {"cd":"0903","name":"农业资源与环境","count":7},
    // {"cd":"0803","name":"光学工程","count":6},
    // {"cd":"0713","name":"生态学","count":6},
    // {"cd":"0823","name":"交通运输工程","count":5},
    // {"cd":"0907","name":"林学","count":5},
    // {"cd":"0711","name":"系统科学","count":5},
    // {"cd":"0820","name":"石油与天然气工程","count":4},
    // {"cd":"0804","name":"仪器科学与技术","count":4},
    // {"cd":"1005","name":"中医学","count":4},
    // {"cd":"1004","name":"公共卫生与预防医学","count":3},
    // {"cd":"0830","name":"环境科学与工程","count":3},
    // {"cd":"0402","name":"心理学","count":3},
    // {"cd":"0826","name":"兵器科学与技术","count":2},
    // {"cd":"0824","name":"船舶与海洋工程","count":2},
    // {"cd":"0712","name":"科学技术史","count":2},
    // {"cd":"0819","name":"矿业工程","count":2},
    // {"cd":"0828","name":"农业工程","count":2},
    // {"cd":"0906","name":"兽医学","count":2},
    // {"cd":"0837","name":"安全科学与工程","count":1},
    // {"cd":"0905","name":"畜牧学","count":1},
    // {"cd":"1201","name":"管理科学与工程","count":1},
    // {"cd":"0835","name":"软件工程","count":1},
    // {"cd":"0908","name":"水产","count":1},
    // {"cd":"0714","name":"统计学","count":1},
    // {"cd":"0839","name":"网络空间安全","count":1},
    // {"cd":"0902","name":"园艺学","count":1},
    // {"cd":"0101","name":"哲学","count":1},
    // {"cd":"0602","name":"中国史","count":1},
    // {"cd":"1006","name":"中西医结合","count":1}
  ],
  "engineering": [
    {"cd":"1002","name":"临床医学","count":82},
    {"cd":"0805","name":"材料科潍工程","count":70},
    {"cd":"0814","name":"土木工程","count":53},
    {"cd":"0825","name":"航空宇删泻技术","count":48},
    {"cd":"0810","name":"信息与通信工程","count":46},
    {"cd":"0817","name":"化学工程与技术","count":41},
    {"cd":"0802","name":"机械工程","count":40},
    {"cd":"0815","name":"水利工程","count":40},
    {"cd":"0827","name":"核科学与技术","count":29},
    {"cd":"0901","name":"作物学","count":27},
    {"cd":"0811","name":"控制科洱工程","count":26},
    {"cd":"1007","name":"药学","count":26},
    {"cd":"0813","name":"建筑学","count":24},
    {"cd":"0702","name":"物理学","count":24},
    {"cd":"0710","name":"生物学","count":23},
    {"cd":"0808","name":"电气工程","count":22},
    {"cd":"0830","name":"环境科学与工程","count":22},
    {"cd":"0812","name":"计算机科学与技术","count":22},
    {"cd":"0806","name":"冶金工程","count":22},
    {"cd":"0807","name":"动力工程及工程热物理","count":21},
    {"cd":"0819","name":"矿业工程","count":21},
    {"cd":"0801","name":"力学","count":20},
    {"cd":"0820","name":"石油与天然气工程","count":19},
    {"cd":"0826","name":"兵器科学与技术","count":18},
    {"cd":"0809","name":"电子科学与技术","count":17},
    {"cd":"0824","name":"船舶与海洋工程","count":16},
    {"cd":"0703","name":"化学","count":15},
    {"cd":"0907","name":"林学","count":14},
    {"cd":"0816","name":"测绘科学与技术","count":12},
    // {"cd":"0709","name":"地质学","count":12},
    // {"cd":"0823","name":"交通运输工程","count":12},
    // {"cd":"0818","name":"地质资源与地质工程","count":11},
    // {"cd":"1201","name":"管理科学与工程","count":11},
    // {"cd":"0803","name":"光学工程","count":11},
    // {"cd":"0707","name":"海洋科学","count":11},
    // {"cd":"0904","name":"植物保护","count":10},
    // {"cd":"1001","name":"基础医学","count":8},
    // {"cd":"0906","name":"兽医学","count":8},
    // {"cd":"0902","name":"园艺学","count":8},
    // {"cd":"0905","name":"畜牧学","count":7},
    // {"cd":"0706","name":"大气科学","count":7},
    // {"cd":"1004","name":"公共卫生与预防医学","count":7},
    // {"cd":"0713","name":"生态学","count":7},
    // {"cd":"0908","name":"水产","count":7},
    // {"cd":"0804","name":"仪器科学与技术","count":7},
    // {"cd":"0828","name":"农业工程","count":6},
    // {"cd":"0822","name":"轻工技术与工程","count":6},
    // {"cd":"1005","name":"中医学","count":6},
    // {"cd":"0831","name":"生物医学工程","count":5},
    // {"cd":"0832","name":"食品科学与工程","count":5},
    // {"cd":"0821","name":"纺织科洱工程","count":4},
    // {"cd":"1008","name":"中药学","count":4},
    // {"cd":"0909","name":"草学","count":3},
    // {"cd":"0705","name":"地理学","count":3},
    // {"cd":"1105","name":"军队指挥学","count":3},
    // {"cd":"0903","name":"农业资源与环境","count":3},
    // {"cd":"0837","name":"安全科学与工程","count":2},
    // {"cd":"0833","name":"城乡规划学","count":2},
    // {"cd":"0708","name":"地球物理学","count":2},
    // {"cd":"1202","name":"工商WS","count":2},
    // {"cd":"1003","name":"口腔医学","count":2},
    // {"cd":"0835","name":"软件工程","count":2},
    // {"cd":"0701","name":"数学","count":2},
    // {"cd":"0834","name":"风景园林学","count":1},
    // {"cd":"0838","name":"公安技术","count":1},
    // {"cd":"0829","name":"林业工程","count":1},
    // {"cd":"0704","name":"天文学","count":1},
    // {"cd":"0839","name":"网络空间安全","count":1},
    // {"cd":"0711","name":"系统科学","count":1},
    // {"cd":"1006","name":"中西医结合","count":1}
],
  "ie": 9743
};

var sciencesJson = {
  "数学物理": 153,
  "化学": 129,
  "生命科学和医学": 149,
  "地学": 136,
  "信息技术科学": 97,
  "技术科学": 149,
};

var engineeringJson = {
  "化工、冶金与材料": 114,
  "机械与运载": 129,
  "信息与电子": 131,
  "能源与矿业": 125,
  "环境与轻纺": 60,
  "农业": 83,
  "医药卫生": 121,
  "工程管理": 69,
  "土木、水利与建筑": 103,
};

var waterMarkText = 'ECHARTS';

var canvas = document.createElement('canvas');
var ctx = canvas.getContext('2d');
canvas.width = canvas.height = 100;
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';
ctx.globalAlpha = 0.08;
ctx.font = '20px Microsoft Yahei';
ctx.translate(50, 50);
ctx.rotate(-Math.PI / 4);
ctx.fillText(waterMarkText, 0, 0);

option = {
    backgroundColor: {
        type: 'pattern',
        image: canvas,
        repeat: 'repeat'
    },
    tooltip: {},
    title: [{
        text: '一级学科',
        // subtext: '总计 ' + subjectJson.all,
        left: '70%',
        textAlign: 'center'
    }, {
        text: '中国科学院',
        subtext: '总计 ' + Object.keys(sciencesJson).reduce(function (all, key) {
            return all + sciencesJson[key];
        }, 0),
        left: '20%',
        textAlign: 'center'
    }, {
        text: '中国工程院',
        subtext: '总计 ' + Object.keys(engineeringJson).reduce(function (all, key) {
            return all + engineeringJson[key];
        }, 0),
        left: '20%',
        top: '50%',
        textAlign: 'center'
    }],
    grid: [
        {
            top: 50,
            width: '60%',
            // bottom: '45%',
            left: '40%',
            containLabel: true
        }, 
        {
            top: '55%',
            width: '60%',
            bottom: 0,
            left: '40%',
            containLabel: true
        }
    ],
    xAxis: [{
        type: 'value',
        max: subjectJson.all,
        splitLine: {
            show: false
        },
        position: 'top'
    }, 
    // {
    //     type: 'value',
    //     max: subjectJson.all,
    //     gridIndex: 1,
    //     splitLine: {
    //         show: false
    //     }
    // }
    ],
    yAxis: [{
        type: 'category',
        // data: Object.keys(subjectJson.sciences),
        data: Object.keys(subjectJson.both),
        show: false,
        axisLabel: {
            interval: 0,
            rotate: 30
        },
        splitLine: {
            show: false
        }
    }, 
    // {
    //     gridIndex: 1,
    //     type: 'category',
    //     data: Object.keys(subjectJson.both),
    //     show: false,
    //     axisLabel: {
    //         interval: 0,
    //         rotate: 30
    //     },
    //     splitLine: {
    //         show: false
    //     }
    // }
    ],
    legend: [
        {
            type: 'scroll',
            orient: 'vertical',
            left: '0.3%',
            right: '',
            top: '12%',
            // bottom: '10%',
            data: Object.keys(sciencesJson)
            // selected: data.selected
        },
        {
            type: 'scroll',
            orient: 'vertical',
            left: '0.3%',
            right: '',
            top: '60%',
            // bottom: '10%',
            data: Object.keys(engineeringJson)
            // selected: data.selected
        }
    ],
    dataZoom: [
        // {
        //     // show: true,
        //     start: 0,
        //     end: 100
        // },
        {
            type: 'inside',
            start: 70,
            end: 100,
            // startValue: 80,
            // endValue: 205,
            // minSpan: 40,
            yAxisIndex: 0,
        },
        {
            show: true,
            yAxisIndex: 0,
            filterMode: 'empty',
            width: 30,
            height: '75%',
            showDataShadow: false,
            top: '20%',
            left: '93%'
        }
    ],
    series: [{
        type: 'bar',
        stack: 'chart',
        z: 3,
        label: {
            fontSize: 6,
            normal: {
                position: 'insideLeft',
                // formatter: '{b}: 科学院 {c} 人, 工程院 {@data["engineering"]} 人 {@[2]} {@[3]} {@[4]} {@[5]}',
                formatter: (params) => {
                    // console.log(params)
                    return `${params.name}: 科学院 ${params.data.sciences || 0} 人, 工程院 ${params.data.engineering || 0} 人`
                },
                show: true,
                fontSize: 12,
            }
        },
        data: Object.keys(subjectJson.both).map(function (key) {
            // return subjectJson.sciences[key];
            let item = subjectJson.both[key]
            // return [ item.name, item.sciences || 0, item.engineering || 0 ];
            return { 
                name: item.name,
                value: item.sciences, 
                sciences: item.sciences || 0,
                engineering: item.engineering || 0,
            };            
            // return [
            //     item.name,
            //     item.sciences, 
            //     item.sciences,
            //     item.engineering,
            // ];
        })
        // data: Object.keys(subjectJson.sciences).map(function (key) {
        //     // return subjectJson.sciences[key];
        //     let item = subjectJson.sciences[key]
        //     return { name: item.name, value: item.count };
        // })
    }, {
        type: 'bar',
        stack: 'chart',
        // z: 3,
        // silent: true,
        itemStyle: {
            normal: {
                // color: '#eee'
            }
        },
        // data: Object.keys(subjectJson.sciences).map(function (key) {
        //     return subjectJson.all - subjectJson.sciences[key];
        // })
        // label: {
        //     fontSize: 6,
        //     normal: {
        //         position: 'insideLeft',
        //         // formatter: '{b}: 科学院 {c} 人, 工程院 {@data["engineering"]} 人 {@[2]} {@[3]} {@[4]} {@[5]}',
        //         formatter: (params) => {
        //             // console.log(params)
        //             return `${params.name}: 科学院 ${params.data.sciences || 0} 人, 工程院 ${params.data.engineering || 0} 人`
        //         },
        //         show: true,
        //         fontSize: 12,
        //     }
        // },
        data: Object.keys(subjectJson.both).map(function (key) {
            // return subjectJson.sciences[key];
            let item = subjectJson.both[key]
            // return [ item.name, item.sciences || 0, item.engineering || 0 ];
            return { 
                name: item.name,
                value: item.engineering, 
                sciences: item.sciences || 0,
                engineering: item.engineering || 0,
            }; 
        })
    },
    // {
    //     type: 'bar',
    //     stack: 'component',
    //     xAxisIndex: 1,
    //     yAxisIndex: 1,
    //     z: 3,
    //     label: {
    //         normal: {
    //             position: 'insideLeft',
    //             show: true,
    //             formatter: '{b}: {c}人',
    //             fontSize: 10,
    //         }
    //     },
    //     data: Object.keys(subjectJson.engineering).map(function (key) {
    //         // console.log(item)
    //         let item = subjectJson.engineering[key]
    //         return { name: item.name, value: item.count };
    //     }),
    // }, 
    // {
    //     type: 'bar',
    //     stack: 'component',
    //     silent: true,
    //     xAxisIndex: 1,
    //     yAxisIndex: 1,
    //     itemStyle: {
    //         normal: {
    //             color: '#eee'
    //         }
    //     },
    //     // large: true,
    //     // largeThreshold: 10,
    //     // barMinWidth: 20,
    //     data: Object.keys(subjectJson.engineering).map(function (key) {
    //         return subjectJson.all - subjectJson.engineering[key];
    //     })
        // }, 
    {
        type: 'pie',
        radius: ['10%', '28%'],
        center: ['28%', '25%'],
        data: Object.keys(sciencesJson).map(function (key) {
            return {
                name: key,
                value: sciencesJson[key]
            }
        }),
        label: {
            position: 'inside',
            // rotate: 'radial',
            formatter: '{c}人',
        },
    }, {
        type: 'pie',
        radius: ['10%', '28%'],
        center: ['28%', '75%'],
        data: Object.keys(engineeringJson).map(function (key) {
            return {
                name: key,
                value: engineeringJson[key]
            };
        }),
        label: {
            position: 'inside',
            // rotate: 'radial',
            // alignTo: 'edge',
            formatter: '{c}人',
            // margin: 10,
            // distanceToLabelLine: 50
            // padding: [0, 10, 0, 120],
        },
        // labelLine: {
        //     // show: false,
        //     length2: 500,
        // },
        // left: 0,
        // right: '50%',
        // // left: '50%',
        // // right: 0,
        // top: 0,
        // bottom: 0
    }]
};;
if (option && typeof option === "object") {
    myChart.setOption(option, true);
}
       </script>
   </body>
</html>